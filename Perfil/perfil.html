<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="styleperfil.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <script src="scriptperfil.js"></script>
    <title>Perfil do Aluno</title>
</head>
<body>
    
    <div class="container">
        <div id="item1">
            <nav id="side-bar">
                <!--<div class="btn-menu">
                    <img src="menu.png" id="expandir">
                </div>-->
        
                <ul>
                    <li class="pag-menu" name="perfil">
                        <a href="#" onclick="redirecionarPerfil()">
                            <span class="icon">
                                <img src="perfilIcon.png">
                            </span>
                            <span class="txt-link" id="span-perfil">Perfil</span>
                        </a>
                    </li>
                    <li class="pag-menu" name="mural">
                        <a href="#" onclick="redirecionarMural()">
                            <span class="icon">
                                <img src="mural.png">
                            </span>
                            <span class="txt-link" id="span-mural">Mural</span>
                        </a>
                    </li>
                    <li class="pag-menu" name="blog">
                        <a href="#" onclick="redirecionarBlog()">
                            <span class="icon">
                                <img src="blog.png">
                            </span>
                            <span class="txt-link">Blog</span>
                        </a>
                    </li>
                    <li class="pag-menu" name="sair">
                        <a href="#">
                            <span class="icon">
                                <img src="sair.png">
                            </span>
                            <span class="txt-link">Sair</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="corpo">

         <div id="capa">
            <img id="ft-capa" src="pexels-photo-6424583 1.png" alt="Foto da Capa">
        </div>

        <div id="perfil">

            <img id="foto" src="ff6a01e0377bb7df597f856a5f5f73c5.png" alt="Foto de Perfil">
    
            <div id="infos">
                <h1 id="user-name" ></h1>
                <p id="user-description"></p>
            </div>
            
            <div id="editar">
                <button onclick="openEditModal()" class="botao" >
                    <img id="img-user" src="perfil-icon.png">
                    Editar Perfil
                </button>
            </div>
            
            <div id="edit-modal" class="modal">
                <div class="edit-modal-content">
                <h2>Editar Perfil</h2>
                <form id="user-profile-form">
                    <p>Alterar foto da capa:</p>
                    <input type="file" id="cover-photo-file" accept="image/*" placeholder="Foto de Capa">
                    
                    <p>Alterar foto do perfil:</p>
                    <input type="file" id="profile-photo-file" accept="image/*" placeholder="Foto de Perfil">
                    
                    <input name="username" type="text" id="user-name-input" placeholder="Alterar Nome">
                    
                    <input name="desc" type="text" id="user-description-input" placeholder="Alterar sua Descrição"></br>

                    <textarea  id="sobre" placeholder="Sobre Você" name="opt" rows="4" cols="50"></textarea><br><br>

                    <input name="LinkPort" type="url" id="link-portfolio" placeholder="Link do seu Portfólio"></br>
                
                    <button class="botao" type="submit" onclick="updateProfile()">Salvar Alterações</button>
                    <button class="botao" type="button" onclick="closeEditModal()">Fechar</button>
                </form>
                </div>
            </div>
        </div>

        <div id="projetos-salvos">
            <div class="guia ativa" id="guia-projetos">Projetos</div>
            <div class="guia" id="guia-salvos">Sobre</div>
        </div>

        <div id=div-adc-projetos>
        <button type="button" onclick="openAddProjetos()" class="botao" id="adicionar-projetos">
            <img id="img-projetos" src="adcprojeto.png">
            Novo Projeto
        </button>
        </div> 


        <div id="projetos" >

            <div id="overlay">

                <div class="position" >
                    <p id="nome">Projeto</p>
                </div>


            </div>
            
            <div id="container" class="centro-div">
                <div id="campo-img">
                    <img id="img" src="img_conteudo.png" alt="Minha Imagem">
                </div>

                <div id="campo-descricao">
                        
                        <p class="descricao"><b>Sugestões para a descriçaõ do seu projeto:</b> </p>
                        <p class="descricao"><b>Título do Projeto:</b> Dê um título ao projeto</p>
                        <p class="descricao"><b>Resumo do Projeto: </b>Forneça um breve resumo do projeto</p>
                        <p class="descricao"><b>Tecnologias Utilizadas:</b> Liste as tecnologias, ferramentas ou linguagens de programação usadas no projeto</p>
                        

                    
                </div> 

                <button onclick="abrirLink()" class="botao-no-centro" id="btn-vermais">Veja Mais</button>

            </div>

            <div id="style-aux"></div>
    
        </div>
        
        <div id="salvos" style="display: none;">
            <h3>Sobre</h3>
            <p id="sobre-vc"></p>
            <a href="" id="link-port"></a>
        </div>
        
        <div id="add-projetos" class="modal">
            <div class="edit-modal-content">
            <h2>Adicionar Projeto</h2>
            <form id="user-profile-form">
                <input type="text" id="nome-projeto" placeholder="Nome do Projeto"> 

                
                <textarea id="descri-projeto" placeholder="Descrição do Projeto" name="opt" rows="4" cols="50"></textarea><br><br>

                <input type="url" id="link-projeto" placeholder="Link do Repositorio do Projeto"></br>

                <p>Selecione foto do projeto:</p>
                <input type="file" id="foto-projeto" accept="image/*" placeholder="Foto de Capa">

                <button class="botao" type="button" onclick="updateProjeto()">Salvar Alterações</button>
                <button class="botao" type="button" onclick="closeEditProjeto()">Fechar</button>
            </form>
            </div>
        </div>

        
    </div>      
    <script>
        fetch("http://localhost:5433/projeto/VerPerfil")
        .then((res) => {
          return res.json();
        })
        .then((data) => {
            let dados = Object.values(data)

            const nomeUSER = `
                    <p>${dados[0].Nome}</p>
                `;
            document.querySelector("#user-name").insertAdjacentHTML("beforeend", nomeUSER);

            const descCurso = `
                    <p>${dados[0].Curso}</p>
                `;
            document.querySelector("#user-description").insertAdjacentHTML("beforeend", descCurso);

            const descUser = `
                    <p>${dados[0].descricaoUsuario}</p>
                `;
            document.querySelector("#sobre-vc").insertAdjacentHTML("beforeend", descUser);


            const linkPort = `
                <a href="${dados[0].linkPort}">${dados[0].linkPort}</a>
            `
            document.querySelector("#link-port").insertAdjacentHTML("beforeend", linkPort);
        })
        .catch((error) => console.log(error));



        const formE1 = document.querySelector("#user-profile-form");
    
            formE1.addEventListener("submit", (event) => {
              event.preventDefault();
    
              const formData = new FormData(formE1);
    
              let UserName = formData.get("username")
              let DescUser = formData.get("desc")
              let PortLink = formData.get("LinkPort")
              let sobreVC = formData.get("opt")
        
              const data = new URLSearchParams(formData)
    
              fetch('http://localhost:5433/projeto/attUser', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body :  JSON.stringify({
                        "Nome" : `${UserName}`,
                        "Curso" : `${DescUser}`, 
                        "descricaoUsuario" : `${sobreVC}`,
                        "linkPort" : `${PortLink}`
                    })
              }).then(res => res.json())
                .then(data => console.log(data))
                .catch(error => console.log(error))
    
            })
    
    </script>
</body>
</html>